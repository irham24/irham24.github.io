
<!DOCTYPE html>
<html>
<head>
	
	<!-- Primary Meta Tags -->
	<title>IrhaMap - Learning the history with GIS</title>
	<meta name="title" content="Interactive and Responsive Historical Map | IrhaMap">
	<meta name="description" content="Let's back to the past with GIS">

	<!-- Open Graph / Facebook -->
	<meta property="og:type" content="website">
	<meta property="og:url" content="https://irham24.github.io/maps/">
	<meta property="og:title" content="Interactive and Responsive Historical Map | IrhaMap">
	<meta property="og:description" content="Back to the past with GIS">
	<meta property="og:image" content="https://i.ibb.co/2ktvzzJ/Peta-Tua-Cover.png">

	<!-- Twitter -->
	<meta property="twitter:card" content="summary_large_image">
	<meta property="twitter:url" content="https://irham24.github.io/maps/">
	<meta property="twitter:title" content="Interactive and Responsive Historical Map | IrhaMap">
	<meta property="twitter:description" content="Back to the past with GIS">
	<meta property="twitter:image" content="https://i.ibb.co/2ktvzzJ/Peta-Tua-Cover.png">

	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="shortcut icon" href="./assets/img/favicon.ico"/>
	
	<!-- Leaflet -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.3/dist/leaflet.css" integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ==" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.3.3/dist/leaflet.js" integrity="sha512-tAGcCfR4Sc5ZP5ZoVz0quoZDYX5aCtEm/eu1KhSLj2c9eFrylXZknQYmxUssFaVJKvvc0dJQixhGjG2yXWiV9Q==" crossorigin=""></script>
	
	<!-- Font Awesome -->
	<script src="https://kit.fontawesome.com/a076d05399.js"></script>
	<!-- JQuery -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	
	<!-- Leaflet side by side -->
	<script src="https://ghcdn.rawgit.org/digidem/leaflet-side-by-side/gh-pages/leaflet-side-by-side.js"></script>
	
	<!-- Easy Button -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet-easybutton@2/src/easy-button.css">
	<script src="https://cdn.jsdelivr.net/npm/leaflet-easybutton@2/src/easy-button.js"></script>
	<style>
		html, body {
			height: 100vh;
			min-height: -webkit-fill-available;
			width: 100%;
			margin: 0;
			overflow-y: hidden;
			position: fixed;
		}
		#map {
			height: 100%;
			width: 100%;
			z-index: 10;
		}
		
		.leaflet-control-layers-header {
			font-size: larger;
			font-weight: bold;
			display: block;
			position: relative;
		}
		
				
		.sidenav {
		  height: 100%;
		  width: 25%;
		  position: fixed;
		  z-index: 9999;
		  top: 0;
		  left: -25%;
		  background-color: #fff;
		  overflow-x: hidden;
		  transition: 0.5s;
		  padding-top: 1%;
		  padding-bottom: 1%;
		}
		
		.btnSidenav {
		  height: 30px;
		  width: 10px;
		  position: fixed;
		  z-index: 9999;
		  top: 8px;
		  left: 0;
		  background-color: #fff;
		  transition: 0.5s;
		  padding-top: 15px;
		  padding-left: 10px;
		  padding-right: 5px;
		  color: #818181;
		}
		
		.btnIcon :hover{
		  color: #111;
		}
		
		.bottom-drawer{
		  height:100%;
		  width:100%;
		  top: 100vh - 40px;
		  z-index: 9999;
		  position: absolute;
		  border-top-left-radius: 12px;
		  border-top-right-radius: 12px;
		  background-color: #fff;
		  transition: 0.2s !important;
		}
		
		.drawer-content {
			height: calc(100vh - 32px);
			overflow: auto;
		}
		
		
		/* Tree View */		
		/* Remove default bullets */
		ul, #myUL {
		  list-style-type: none;
		  padding-left : 10px;
		}

		/* Remove margins and padding from the parent ul */
		#myUL {
		  margin: 0;
		  padding: 0;
		}

		/* Style the caret/arrow */
		.caret {
		  cursor: pointer;
		  user-select: none; /* Prevent text selection */
		}

		/* Create the caret/arrow with a unicode, and style it */
		.caret::before {
		  content: "\25B6";
		  color: black;
		  display: inline-block;
		  margin-right: 6px;
		}

		/* Rotate the caret/arrow icon when clicked on (using JavaScript) */
		.caret-down::before {
		  transform: rotate(90deg);
		}

		/* Hide the nested list */
		.nested {
		  display: none;
		}

		/* Show the nested list when the user clicks on the caret/arrow (with JavaScript) */
		.active {
		  display: block;
		}
	</style>
	
</head>
<body>

<div id='map'></div>
<section class="sidenav-sec"></section>
<section class="bottom-drawer"></section>
<script>
	// STARTING
	document.body.style.height = window.innerHeight + 'px';
	document.getElementsByTagName("html")[0].style.height = window.innerHeight + 'px';
	$('#bottom-sheet').css("height",window.innerHeight + 'px');
	var btmDrawerHeight = window.innerHeight * 3 /100;
	var btmDrawerHalfHeight = window.innerHeight * 40 /100;
	
	// Checking the used device
	var mobileCheck = (window.innerWidth < window.innerHeight);
	var infoBox = mobileCheck ? '.drawer-content' : '.sidenav-content'
	var otherInfoBox = mobileCheck ? '.sidenav-sec' : '.bottom-drawer'	

	//Drawer
	$(document).ready(function() {
		var click = false
		var pos = 0
		//if (mobileCheck){
			$('#bottom-sheet').mousedown(function(e) {
				e.preventDefault();
				click = true
			})
			$('#bottom-sheet').on('touchstart', function(e) {
				e.preventDefault();
				click = true
			})
			$(window).mousemove(function(e) {
				mouseMove(e)
			})
			$(window).mouseup(function(e) {
				mouseUp(e)
			})
			$(window).on('touchmove', function(e) {
				mouseMove(e.touches[0])
			})
			$(window).on('touchend', function(e) {
				mouseUp(e.changedTouches[0])
				// console.log(e.changedTouches[0].pageY)
			})
		//}
		function mouseMove(e) {
			if(click) {
				//console.log(e.pageX, e.pageY)
				
				if(e.pageY > innerHeight - btmDrawerHeight) {
					$('.bottom-drawer').css({
						top: innerHeight - btmDrawerHeight + 'px'
					})
					// click = false
				}else if(e.pageY < 0){
					$('.bottom-drawer').css({
						top: '0px'
					})
				}else{
					$('.bottom-drawer').css({
						top: e.pageY + 'px'
					})
				}
			}
		}
		function mouseUp(e) {
			if(click) {
				//deket bawah
				//pos 0 (dibawah), pos 1 (diatas), pos 2 (hampir tengah)
				if(e.pageY > (innerHeight * 25/100) && pos == 1){ // kalo dari atas tapi scroll kebawah lebih dr 10%
					pos = 0
				} else if((e.pageY < innerHeight - (innerHeight * 5/100) && pos == 0) || // supaya ke tengah
				   (e.pageY > (innerHeight * 5/100) && pos == 1)){
					pos = 2
				} else if(e.pageY < (innerHeight - btmDrawerHalfHeight) - (innerHeight * 2.5/100) && pos == 2){
					pos = 1
				} else if(e.pageY > (innerHeight - btmDrawerHalfHeight) + (innerHeight * 2.5/100) && pos == 2){
					pos = 0
				}
				if(pos==0){				$('.bottom-drawer').css({top: innerHeight - btmDrawerHeight + 'px'});
					} else if (pos==1){	$('.bottom-drawer').css({top: '0px'});
										//$('.bottom-drawer').css({height: innerHeight + 'px'});
					} else {			$('.bottom-drawer').css({top: innerHeight - btmDrawerHalfHeight + 'px'});
										//$('.bottom-drawer').css({height: btmDrawerHalfHeight + 'px'});
				}
			}
			click = false;
		}
	})

	// Sidenav
	function btnNav(){
	//console.log("start");
		if(document.getElementById("btnSidenav").style.left < "25%"){
			document.getElementById("mySidenav").style.left = "0";
			document.getElementById("btnSidenav").style.left = "25%";
			document.getElementById("btnSidenav").style.backgroundColor = "#f1f1f1";
			document.getElementById("btnIcon").className = "fas fa-caret-left";
		} else {
		    document.getElementById("mySidenav").style.left = "-25%";
		    document.getElementById("btnSidenav").style.left = "0";
			document.getElementById("btnSidenav").style.backgroundColor = "#fff";
			document.getElementById("btnIcon").className = "fas fa-caret-right";
		}
	}
	function comparebox(){
		let checkBox = document.getElementById("myCheck");
		if (checkBox.checked == true){
			compareControl.addTo(map);
		} else {
			compareControl.remove();
		}
		updateURL();
	}


	// get Param from URLs
	var params = {};
	var i = 0;
	window.location.href.replace(/[?@&]+([^&]*)/gi, function(m, item){
		//params[key] = value;
		if (i==0){
			let item_arr = item.split(",");
			params['lat'] = item_arr[0];
			params['lng'] = item_arr[1];
			params['zoom'] = item_arr[2].replace("z", "");
			//console.log(item_arr);
		} else {
			item_arr = item.split("=");
			if (item_arr[0]=="marked"){
				let value = item_arr[1].split("@");
				params['marked_content'] = value[0];
				if (value.length > 1){
					let coord = value[1].split(",");
					params['marked_lat'] = coord[0];
					params['marked_lng'] = coord[1];
				} else {
					params['marked_lat'] = params['lat'];
					params['marked_lng'] = params['lng'];
				}
			} else {
				params[item_arr[0]] = item_arr[1];
			}
		}
		i+=1;
	});
	//console.log(params);


	// Basemap map
	
	// Esri Basemap
	//L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}', {
	//	attribution: 'Tiles &copy; Esri &mdash; Source: Esri, DeLorme, NAVTEQ, USGS, Intermap, iPC, NRCAN, Esri Japan, METI, Esri China (Hong Kong), Esri (Thailand), TomTom, 2012'
	//}).addTo(map);
	
	// OSM Basemap
	var osmLayer = L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap<\/a> contributors'
    });
	// Google Streets Basemap
	var googleStreets = L.tileLayer('http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}',{
    maxZoom: 20,
    subdomains:['mt0','mt1','mt2','mt3'],
	attribution: 'Basemap &copy; Google'
	});
	// Google Satelite Basemap
	var googleSat = L.tileLayer('http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}',{
    maxZoom: 20,
    subdomains:['mt0','mt1','mt2','mt3'],
	attribution: 'Basemap &copy; Google'
	});
	// Google Hybrid Basemap
	var googleHybrid = L.tileLayer('http://{s}.google.com/vt/lyrs=s,h&x={x}&y={y}&z={z}',{
    maxZoom: 20,
    subdomains:['mt0','mt1','mt2','mt3'],
	attribution: 'Basemap &copy; Google'
	});
	var basemap_default = osmLayer
	
	// Data
	
	// Old Atlas
	var oldTilesAtlas = L.tileLayer('https://maps.georeferencer.com/georeferences/4d239dd5-e40b-5b47-802a-902f6010704c/2019-11-17T19:53:34.045791Z/map/{z}/{x}/{y}.png?key=sPjsmpzUociMSuMg5BlY',{
    maxZoom: 20,
	attribution: "(1) Typus Orbis Terrarum. by Ortelius, Abraham, 1527-1598; Tiles <a href='https://davidrumsey.georeferencer.com/maps/4e930a7e-3839-5263-8959-502ee675442a/'>davidrumsey.com</a>.",
	id:"4d239dd5-e40b-5b47-802a-902f6010704c"
	});
	
	// Old Atlas
	var oldTilesAtlas2 = L.tileLayer('https://maps.georeferencer.com/georeferences/11a84caa-a653-5b29-9728-93555bebd62f/2020-06-25T21:29:22.834301Z/map/{z}/{x}/{y}.png?key=sPjsmpzUociMSuMg5BlY',{
    maxZoom: 20,
	attribution: "128-129. Indonesia. The World Atlas by USSR (Union of Soviet Socialist Republics); 1967; Tiles <a href='https://davidrumsey.georeferencer.com/maps/a016c171-dd3f-55fa-a5a7-9bb6f0b79a3d/'>davidrumsey.com</a>.",
	id:"a016c171-dd3f-55fa-a5a7-9bb6f0b79a3d"
	});
	
	// Old Atlas
	var oldTilesAtlas3 = L.tileLayer('https://maps.georeferencer.com/georeferences/d39f475a-61e5-585d-a2cd-744c341ddcef/2017-03-22T21:35:39.075608Z/map/{z}/{x}/{y}.png?key=sPjsmpzUociMSuMg5BlY',{
    maxZoom: 20,
	attribution: "Composite: A Chart of the World upon Mercator's projection exhibiting all the new discoveries. Sheets 1-8. by Arrowsmith, Aaron; 1808; Tiles <a href='https://davidrumsey.georeferencer.com/maps/2be32158-1dc7-5071-94cf-6c9912f5865d/'>davidrumsey.com</a>.",
	id:"2be32158-1dc7-5071-94cf-6c9912f5865d"
	});
	
	// Old Atlas
	var oldTilesAsia = L.tileLayer('https://maps.georeferencer.com/georeferences/3ff3a0c0-c845-5639-916d-5b306ddde711/2020-07-22T11:39:34.827989Z/map/{z}/{x}/{y}.png?key=sPjsmpzUociMSuMg5BlY',{
    maxZoom: 20,
	attribution: "A New Map of East India. by Speed, John, 1542-1629; 1676; Tiles <a href='https://davidrumsey.georeferencer.com/maps/a016c171-dd3f-55fa-a5a7-9bb6f0b79a3d/'>davidrumsey.com</a>.",
	id:"3ff3a0c0-c845-5639-916d-5b306ddde711"
	});
	
	// Old Atlas
	var oldTilesAsia2 = L.tileLayer('https://maps.georeferencer.com/georeferences/7ad0719c-51b7-5e78-bffe-834025435c15/2020-01-27T05:07:24.246354Z/map/{z}/{x}/{y}.png?key=sPjsmpzUociMSuMg5BlY',{
    maxZoom: 20,
	attribution: "(48) Indiae Orientalis. by Ortelius, Abraham, 1527-1598; 1570; Tiles <a href='https://davidrumsey.georeferencer.com/maps/c015bf3c-c8c7-5ee0-8331-3ed7f4baf716/'>davidrumsey.com</a>.",
	id:"7ad0719c-51b7-5e78-bffe-834025435c15"
	});
	
	// Old Atlas
	var oldTilesAsia3 = L.tileLayer('https://geo.leventhalmap.org/maps/tile/1379/{z}/{x}/{y}.png',{
    maxZoom: 20,
	attribution: "Nova et exacta Asiae geographica descriptio by Allard, Huych, 1625-1691; 1660; Tiles <a href='https://collections.leventhalmap.org/search/commonwealth:st74cw78w'>Norman B. Leventhal Map Center Collection</a>.",
	id:"st74cw78w"
	});
	
	// Old Atlas
	var oldTilesAsia4 = L.tileLayer('https://geo.leventhalmap.org/maps/tile/6923/{z}/{x}/{y}.png',{
    maxZoom: 20,
	attribution: "To the Right Honourable William, Lord Cowper, Lord High Chancellor of Great Britain, this map of Asia .. by Moll, Herman, d. 1732; 1710–1719; Tiles <a href='https://collections.leventhalmap.org/search/commonwealth:cj82ks63j'>Norman B. Leventhal Map Center Collection</a>.",
	id:"cj82ks63j"
	});
	
	// Old Atlas
	var oldTilesIndonesia = L.tileLayer('https://maps.georeferencer.com/georeferences/d711d237-f857-5d7c-a269-d71e2cab8eff/2019-06-14T11:33:58.207353Z/map/{z}/{x}/{y}.png?key=sPjsmpzUociMSuMg5BlY',{
    maxZoom: 20,
	attribution: "Kaart van den Nederlandsch-Indischen Archipel by Topografische Inrichting Batavia; 1920; Tiles <a href='https://leiden.georeferencer.com/maps/10310bda-a8b9-531a-90e6-506f50caa994/'>Universiteit Leiden</a>.",
	id:"10310bda-a8b9-531a-90e6-506f50caa994"
	});
	
	// Old Atlas
	var oldTilesIndonesia2 = L.tileLayer('https://maps.georeferencer.com/georeferences/d436717e-384f-5e8c-a2b4-f55a1cb296ec/2019-06-07T13:07:57.042769Z/map/{z}/{x}/{y}.png?key=sPjsmpzUociMSuMg5BlY',{
    maxZoom: 20,
	attribution: "Indonesië : voorlopige staatkundige ordening, bijgewerkt tot 1 october 1949; 1949; Tiles <a href='https://leiden.georeferencer.com/maps/c8d7dc1b-1dcb-5f14-a417-a5d26cbccff8/'>Universiteit Leiden</a>.",
	id:"c8d7dc1b-1dcb-5f14-a417-a5d26cbccff8"
	});
	
	// Google Hybrid Basemap
	var oldTilesJava2 = L.tileLayer('https://maps.georeferencer.com/georeferences/f4d811bd-84f3-5fb8-9726-58ad2b65690d/2020-06-08T13:04:42.118227Z/map/{z}/{x}/{y}.png?key=sPjsmpzUociMSuMg5BlY',{
    maxZoom: 20,
	attribution: "Reduzirte Karte vom Sunda- Oder Borneo-Meere und den Strassen zur ... by dem .. Admiral Krusenstern [...] gewidmet von H. Berghaus; 1835; Tiles <a href='https://uu.georeferencer.com/maps/8c5d0f61-9f1d-58f8-9312-8582489be2bb/'>Utrecht University</a>.",
	id:"8c5d0f61-9f1d-58f8-9312-8582489be2bb"
	});
	
	// Google Hybrid Basemap
	var oldTiles = L.tileLayer('https://maps.georeferencer.com/georeferences/1bc7a3d8-866c-585b-84ba-899a91efabaa/2020-02-11T09:13:45.592512Z/map/{z}/{x}/{y}.png?key=sPjsmpzUociMSuMg5BlY',{
    maxZoom: 20,
	attribution: "Kaart van Nederlands Oostindische bezittingen on Ackersdijck Collection; 1843; Tiles <a href='https://uu.georeferencer.com/maps/5c7f3cbb-51e3-59ba-ba8f-1f9d685ee0ae/'>Utrecht University</a>.",
	id:"5c7f3cbb-51e3-59ba-ba8f-1f9d685ee0ae"
	});
	
	// Google Hybrid Basemap
	var oldTiles2 = L.tileLayer('https://maps.georeferencer.com/georeferences/2d9a279c-f8ea-5904-a92c-f6b4c6433c23/2019-06-14T08:43:58.218505Z/map/{z}/{x}/{y}.png?key=sPjsmpzUociMSuMg5BlY',{
    maxZoom: 20,
	attribution: "Bevolkingskaart van Nederlandsch Oost-Indië / J. Kuyper on KITLV Heritage Collection; 1890; Tiles <a href='https://leiden.georeferencer.com/maps/7ac9d994-87bc-5b7e-a31c-163dcb1e7486/'>Universiteit Leiden</a>.",
	id:"7ac9d994-87bc-5b7e-a31c-163dcb1e7486"
	});
	
	// Google Hybrid Basemap
	var oldTiles3 = L.tileLayer('http://maps.georeferencer.com/georeferences/38b6b69b-b527-564c-a70a-491381428e2e/2018-01-15T10:30:24.598882Z/map/{z}/{x}/{y}.png?key=sPjsmpzUociMSuMg5BlY',{
    maxZoom: 20,
	attribution: "La presqu'isle de l'Indie au dela du Gange, avec l'archipel des Indes by Bonne, Rigobert; 1787; Tiles <a href='http://cuni.georeferencer.com/maps/7030ed26-ef46-5851-85d2-02bc7777d299/'>staremapy.cz</a>.",
	id:"7030ed26-ef46-5851-85d2-02bc7777d299"
	});
	
	// Google Hybrid Basemap
	var oldTiles4 = L.tileLayer('http://maps.georeferencer.com/georeferences/b575c778-daec-5341-8c15-b2bce7c8561a/2018-01-15T10:30:24.598882Z/map/{z}/{x}/{y}.png?key=sPjsmpzUociMSuMg5BlY',{
    maxZoom: 20,
	attribution: "CARTE DES INDES ORIENTALES by Mayer, Tobias; 1748; Tiles <a href='http://cuni.georeferencer.com/maps/755be85c-97b4-5f04-b316-0e55347043f2/'>staremapy.cz</a>.",
	id:"b575c778-daec-5341-8c15-b2bce7c8561a"
	});
	
	// Google Hybrid Basemap
	var oldTilesJava = L.tileLayer('https://maps.georeferencer.com/georeferences/253cc15b-bf50-5f45-a15f-a22f42ea3e1d/2019-06-06T09:54:03.402984Z/map/{z}/{x}/{y}.png?key=sPjsmpzUociMSuMg5BlY',{
    maxZoom: 20,
	attribution: "Nouvelle Carte de l'isle de Java by de Wed. S. Schouten en Zoon et al.; 1755; Tiles <a href='https://leiden.georeferencer.com/maps/8ddef876-2303-5d88-923a-c1c49e3a22c7/'>Universiteit Leiden</a>.",
	id:"8ddef876-2303-5d88-923a-c1c49e3a22c7"
	});
	
	// Google Hybrid Basemap
	var oldTilesCirebon = L.tileLayer('https://maps.georeferencer.com/georeferences/a0180fff-aa14-51b8-9ae8-1a7adf7eced3/2019-06-07T09:26:36.104379Z/map/{z}/{x}/{y}.png?key=sPjsmpzUociMSuMg5BlY',{
    maxZoom: 20,
	attribution: "reede Cheribon by Melvill van Carnbee; 1886; Tiles <a href='https://leiden.georeferencer.com/maps/9d27ee86-c300-5359-9855-b7e9bca1099e/'>Universiteit Leiden</a>.",
	id:"a0180fff-aa14-51b8-9ae8-1a7adf7eced3"
	});
	
	// Google Hybrid Basemap
	var oldTilesBatavia = L.tileLayer('https://maps.georeferencer.com/georeferences/4b43c2c9-fb46-52c2-9ea9-bc22e2781295/2019-06-19T12:08:40.956428Z/map/{z}/{x}/{y}.png?key=sPjsmpzUociMSuMg5BlY',{
    maxZoom: 20,
	attribution: "Kaart van Batavia en Omstreken by Topographisch Bureau Batavia; 1897; Tiles <a href='https://leiden.georeferencer.com/maps/ac7e7df1-6aea-5748-a315-c09fafd3ac17/'>Universiteit Leiden</a>.",
	id:"ac7e7df1-6aea-5748-a315-c09fafd3ac17"
	});
	
	// Google Hybrid Basemap
	var oldTilesSumatra = L.tileLayer('https://maps.georeferencer.com/georeferences/39ba733c-b255-5362-8a83-dd86a06fc89d/2019-11-08T16:25:46.431122Z/map/{z}/{x}/{y}.png?key=sPjsmpzUociMSuMg5BlY',{
    maxZoom: 20,
	attribution: "To Captain Samuel Ashmore, in acknowledgement of much valuable information given, ... inscribed by James Horsburgh; 1832; Tiles <a href='https://uu.georeferencer.com/maps/130243b8-5c89-5d56-b11e-2b516e146d10/'>Utrecht University</a>.",
	id:"130243b8-5c89-5d56-b11e-2b516e146d10"
	});
	
	// Variabel map
	var map = L.map('map', {
		center: [params.lat || -6.269577,
				 params.lng || 106.705615],
		zoom: params.zoom || 11,
		layers: [basemap_default],
		zoomControl: false
	});	
	
	//Scale bar
	new L.control.scale({ metric: true, imperial:false,  position: 'bottomright' 
	}).addTo(map);
	// Zoom controller
	new L.Control.Zoom({ position: 'bottomright' }).addTo(map);
	// Share Button
	L.easyButton({
	  id: 'id-for-the-button',  // an id for the generated button
	  position: 'bottomright',      // inherited from L.Control -- the corner it goes in
	  type: 'replace',          // set to animate when you're comfy with css
	  leafletClasses: true,     // use leaflet classes to style the button?
	  states:[{                 // specify different icons and responses for your button
		stateName: 'get-sharelink',
		onClick: function(button, map){
			//let copyText = window.location.href;
			let copyText = document.createElement('textarea');
			copyText.value = window.location.href;
			document.body.appendChild(copyText);
			/* Select the text field */
			copyText.select();
			copyText.setSelectionRange(0, 99999); /*For mobile devices*/
			document.execCommand("copy");
			document.body.removeChild(copyText);
			alert('Link copied to clipboard');
		},
		title: 'Share',
		icon: 'fa-share-alt'
	  }]
	}).addTo(map);
	
	// Marker Mess
	var marker = L.marker([-6.269577, 106.705615]);
	marker.bindPopup("Point");//.openPopup();
	
	// leaflet-color-markers by pointhi
	var redIcon = new L.Icon({
	  iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png',
	  shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
	  iconSize: [25, 41],
	  iconAnchor: [12, 41],
	  popupAnchor: [1, -34],
	  shadowSize: [41, 41]
	});
	
	// Marked Point
	if (params.marked_content){
		var marked = L.marker([params.marked_lat || params.lat || map.getCenter().lat,
				       params.marked_lng || params.lng || map.getCenter().lng],
				       {icon: redIcon}).addTo(map);
		marked.bindPopup(decodeURIComponent(params.marked_content)).openPopup();
	};
	
	
	//Other Ver
	//var oldWMTS = L.tileLayer.wms('https://maps.georeferencer.com/georeferences/69c451b6-0b1a-5315-9e17-88930d099731/2020-04-07T17:48:47.586709Z/wmts?key=sPjsmpzUociMSuMg5BlY&SERVICE=WMTS&REQUEST=GetCapabilities', {
	//	layers: 'TOPO-WMS,OSM-Overlay-WMS'
	//}).addTo(map);
	
	//Variabel untuk Layer Controller
	var baseMaps = {
		"OSM": osmLayer,
		"Streetview": googleStreets,
		"Satellite": googleSat,
		"Hybrid": googleHybrid
	};
	var overlayArray = [
		oldTilesAtlas2,
		oldTilesAtlas3,
		oldTilesIndonesia2,
		oldTilesIndonesia,
		oldTiles2,
		oldTiles,
		oldTilesJava2,
		oldTiles3,
		oldTiles4,
		oldTilesJava,
		oldTilesAsia4,
		oldTilesAsia,
		//oldTilesAtlas,
		oldTilesAsia3,
		oldTilesAsia2,
		oldTilesCirebon,
		oldTilesBatavia,
		oldTilesSumatra,
	]
	
	// adding id to overlay and other infos
	var i = 0;
	var overlayMaps = {};
	
	overlayArray.forEach(function(overlay){
		//for array
		let attr = overlay.options.attribution.split(';');
		overlay.id = overlay.options.id;
		overlay.title = attr[0];
		overlay.year = attr[1].replace(' ','');
		//for dict
		overlayMaps[overlay.id] = overlay
		i++;
	});
	
	
	// read param for layer and basemap
	if (params.layers){
		var activeLayers = params.layers.split(';').map(function(item){
			// map function not supported in IE < 9
			//console.log(item);
			overlayMaps[decodeURIComponent(item)].addTo(map)
		})
	}
	if (params.basemap){
		osmLayer.remove()
		baseMaps[params.basemap].addTo(map);
	}
	
	// side by side
	var compareControl = L.control.sideBySide(null, null);
	
	if (params.compare){
		let checkBox = document.getElementById("myCheck");
		if (params.compare=="true"){
			checkBox.checked = "true";
		} else {
			checkBox.checked = "false";
		}
		comparebox()
	}
	
	// Use the custom grouped layer control, not "L.control.layers"
	//var layerControl= L.control.layers(baseMaps, overlayMaps).addTo(map);
	
	// Change URL after load
	updateURL();
	
	// give param to URL when panning
	function updateURL(e) {
		//console.log(map.zoom.animate);
		text="?@"+map.getCenter().lat+","+map.getCenter().lng+","+map.getZoom()+"z"
		if (marked){
			text+="&marked="+encodeURIComponent(marked.getPopup().getContent());
			if (marked.getLatLng() != map.getCenter()){
				text+="@"+marked.getLatLng().lat+","+marked.getLatLng().lng
			}
		}
		if (!map.hasLayer(basemap_default)){
			Object.keys(baseMaps).forEach(function(key) {
				if (map.hasLayer(baseMaps[key])){
					//console.log(key, baseMaps[key]);
					text+="&basemap="+key
				}
			});
		}
		let i=0;
		overlayArray.forEach(function(overlay){
			
			if (map.hasLayer(overlay)){
				if (i==0){
					text+="&layers="+overlay.id				
				} else {
					text+=";"+overlay.id
				}
				i++;
			}
		});
		if (compareControl._map){
			text+="&compare=true"
		}
		history.replaceState(null,null,text);
	}

	map.on('moveend', updateURL);
	map.on('zoomend', updateURL);
	map.on('baselayerchange', updateURL);
	map.on('overlayadd', updateURL);
	map.on('overlayremove', updateURL);
	
	function layerSwitch(key){
		let layer = overlayMaps[key];
		let elm = "Op"+key
		if (map.hasLayer(layer)){
			layer.remove();
			document.getElementById(elm).disabled = true; 
		} else {
			layer.addTo(map);
			document.getElementById(elm).disabled = false;
			//console.log("harusnya nyala "+ elm);
		}
	}
	
	function baseSwitch(key){
		let layer = baseMaps[key];
		//let elm = "BM_"+key
		layer.addTo(map);
		Object.keys(baseMaps).forEach(function(keyz) {
			if (map.hasLayer(baseMaps[keyz]) && layer != baseMaps[keyz]){baseMaps[keyz].remove();};
		});
		//document.getElementById(elm).disabled = false;
			//console.log("harusnya nyala "+ elm);
		
	}
	
	function layerOpSlider(value,key){
		let layer = overlayMaps[key];
		let elm = "Op"+key
		layer.setOpacity(value/100);
	}
	
	// Responsive resize window
	function resizeWindow(){
		document.querySelector('.bottom-drawer').style.top = window.innerHeight - btmDrawerHeight + 'px'
		if(infoBox){$(infoBox).html('')};
		mobileCheck = (window.innerWidth < window.innerHeight);
		infoBox = mobileCheck ? '.drawer-content' : '.sidenav-content';
		otherInfoBox = mobileCheck ? '.sidenav-sec' : '.bottom-drawer';
		anotherInfoBox = !mobileCheck ? '.sidenav-sec' : '.bottom-drawer';
		//console.log("mobile check: "+mobileCheck);
		//$(anotherInfoBox).css({opacity: '100'})
		//$(otherInfoBox).css({opacity: '0'})
		
		if(mobileCheck){
			$('.bottom-drawer').css("z-index","9999");
			$('.sidenav-sec').css("z-index","0");
			$('.leaflet-control').css("bottom",btmDrawerHeight + 5);
			$('.bottom-drawer').html('<div class="nav-drawer">'+
										'<div class="text-center" id="bottom-sheet" style="padding: 10px">'+
											'<div style="width:100px;height:4px;background-color: #BDBDBD;margin: auto;border-radius: 50px"></div>'+
										'</div>'+
										'<div class="drawer-content" style="padding-top: 5%;padding-bottom: 5%; overflow:auto" id="drawer-content">'+
										'</div>'+
									'</div>');
			$('.sidenav-sec').html();
		} else {
			$('.bottom-drawer').css("z-index","0");
			$('.sidenav-sec').css("z-index","9999");
			$('.sidenav-sec').html('<div id="mySidenav" class="sidenav">'+
										'<div class="sidenav-content" style="padding-left: 5%;padding-right: 5%;"></div>'+
										'<div id="btnSidenav" class="btnSidenav" style="cursor:pointer" onclick="btnNav()"><i id="btnIcon" style="font-size:14px;"class="fas fa-caret-right"></i>'+
									'</div>');
			$('.bottom-drawer').html()
		}
	
	}
	resizeWindow();
	createLayerbox();
	//window.addEventListener('resize',resizeWindow);
	
	// Writing layerbox
	function createLayerbox(){
		$(infoBox).html('<div id="layerbox"></div>')
		var divLB = document.querySelector('#layerbox');
		let html = '';
		
		// Basemap
		html+='<div style="padding-bottom: 10px;padding-left:10px ;font-size:14px;text-align: justify;">Basemaps<br>'
		Object.keys(baseMaps).forEach(function(key) {
			let haslayer = ""
			if (map.hasLayer(baseMaps[key])){haslayer = "checked";}
			html+='<input type="radio" id="BM_'+key+'" name="basemapRadio" value="'+key+'" onclick='+"baseSwitch('"+key+"') "+haslayer+' /> <label for="'+key+'">'+key+'</label><br>'
		});
		html+='</div>'
		
		// Layers
		html+='<ul id="ulLayer"><li><span class="caret">Layers</span><ul class="nested">'
		overlayArray.forEach(function(overlay){
			let nama = overlay.title
			let layer = overlayMaps[overlay.id];
			let haslayer = ""
			if (map.hasLayer(layer)){haslayer = "checked";};
			//console.log(overlay.id+" "+haslayer)
			let maxChar = mobileCheck ? 50 : 30
			if (nama.length>maxChar){ nama = nama.slice(0, maxChar-3) + "...";}
			nama+=" ("+overlay.year+")"
			html +='<li><span class="caret" style="font-size:12px;text-align: justify;" title="'+overlay.title+" ("+overlay.year+")"+'"><input type="checkbox" id="'+overlay.id+'" onclick='+"layerSwitch('"+overlay.id+"') "+haslayer+'>'+nama+'</span><ul class="nested"><li><input type="range" id="Op'+overlay.id+'" oninput="'+"layerOpSlider(this.value,'"+overlay.id+"')"+'" min="0" max="100" value="100" disabled="true">		</li></ul></li>'
		});
		html+='</ul></li></ul>'
		divLB.innerHTML+=html;
	}
	
	// Toogle Tree View
	var toggler = document.getElementsByClassName("caret");
	var i;

	for (i = 0; i < toggler.length; i++) {
	  toggler[i].addEventListener("click", function() {
		this.parentElement.querySelector(".nested").classList.toggle("active");
		this.classList.toggle("caret-down");
	  });
	}
</script>



</body>
</html>
